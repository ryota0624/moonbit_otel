// Generated by `wit-bindgen` 0.50.0.

///|
/// Run the program.
pub fn run() -> Result[Unit, Unit] {
  let stdout = @stdout.get_stdout()
  ignore(stdout.write(@encoding/utf8.encode("start\n").to_fixedarray()))
  run_async(fn() {
    @cmd_main.run_example(
      @otel.OTLPExporterConfig::stdout(stdout_string_println).enable_debug_log(
        print=stdout_println,
      ),
      print=stdout_string_println,
    ) catch {
      err => {
        let _ = stdout.write(
          @encoding/utf8.encode("Error occurred during execution.\n \{err}").to_fixedarray(),
        )
        ()
      }
    }
    ignore(
      stdout.write(@encoding/utf8.encode("start with http\n").to_fixedarray()),
    )
    @cmd_main.run_example(
      @otel.OTLPExporterConfig::http(
        @lib.http_client_provider(),
        endpoint="http://192.168.0.9:4318/v1/traces",
      ).enable_debug_log(print=stdout_println),
      print=stdout_string_println,
    ) catch {
      err => {
        let _ = stdout.write(
          @encoding/utf8.encode("Error occurred during execution.\n \{err}").to_fixedarray(),
        )
        ()
      }
    }
  })
  ignore(stdout.write(@encoding/utf8.encode("end\n").to_fixedarray()))
  Ok(())
}

///|
fn run_async(f : async () -> Unit noraise) -> Unit = "%async.run"

///|
fn stdout_string_println(msg : String) -> Unit {
  stdout_println(msg)
}

///|
fn stdout_println(msg : &Show) -> Unit {
  let stdout = @stdout.get_stdout()
  let _ = stdout.write(
    @encoding/utf8.encode(msg.to_string() + "\n").to_fixedarray(),
  )

}
